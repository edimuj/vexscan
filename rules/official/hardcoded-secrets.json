{
  "$schema": "../rule-schema.json",
  "category": "Hardcoded Secrets",
  "rules": [
    {
      "id": "SECRET-001",
      "title": "AWS access key",
      "description": "AWS access key IDs follow a known format. Hardcoded keys in source code can be exploited for unauthorized cloud access.",
      "severity": "high",
      "contexts": [],
      "pattern": "(AKIA|AGPA|AIDA|AROA|AIPA|ANPA|ANVA|ASIA)[A-Z0-9]{16}",
      "file_extensions": [],
      "remediation": "Use environment variables or a secrets manager (e.g., AWS Secrets Manager) instead of hardcoding keys.",
      "test_cases": {
        "should_match": [
          "aws_key = \"AKIAIOSFODNN7EXAMPLE\"",
          "ASIAJEXAMPLEKEY12345"
        ],
        "should_not_match": [
          "AKIA_SHORT",
          "aws_access_key_id = os.getenv('AWS_KEY')"
        ]
      }
    },
    {
      "id": "SECRET-002",
      "title": "Stripe API key",
      "description": "Stripe secret and publishable keys follow a known format. Exposed keys enable unauthorized payment operations.",
      "severity": "high",
      "contexts": [],
      "pattern": "(sk|pk)_(live|test)_[A-Za-z0-9]{24,}",
      "file_extensions": [],
      "remediation": "Store Stripe keys in environment variables or a secrets manager.",
      "test_cases": {
        "should_match": [
          "sk_live_abcdefghijklmnopqrstuvwx",
          "pk_test_1234567890abcdefghijklmn"
        ],
        "should_not_match": [
          "sk_live_short",
          "stripe_key = os.getenv('STRIPE_KEY')"
        ]
      }
    },
    {
      "id": "SECRET-003",
      "title": "Google API key",
      "description": "Google API keys follow a known format (AIza prefix). Exposed keys can be abused for API quota theft or data access.",
      "severity": "high",
      "contexts": [],
      "pattern": "AIza[A-Za-z0-9_-]{35}",
      "file_extensions": [],
      "remediation": "Use environment variables and restrict API key permissions in the Google Cloud Console.",
      "test_cases": {
        "should_match": [
          "AIzaSyC_abcdefghij-klmnopqrstuvwxyz12345"
        ],
        "should_not_match": [
          "AIzaShort",
          "google_api_key = os.getenv('GOOGLE_KEY')"
        ]
      }
    },
    {
      "id": "SECRET-004",
      "title": "GitHub token",
      "description": "GitHub personal access tokens and other token types follow known prefixes. Exposed tokens enable repository and account access.",
      "severity": "high",
      "contexts": [],
      "pattern": "gh[pousr]_[A-Za-z0-9]{36,}",
      "file_extensions": [],
      "remediation": "Use environment variables or GitHub's built-in secrets management.",
      "test_cases": {
        "should_match": [
          "ghp_ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghij"
        ],
        "should_not_match": [
          "ghp_short",
          "github_token = os.getenv('GH_TOKEN')"
        ]
      }
    },
    {
      "id": "SECRET-005",
      "title": "JWT token",
      "description": "JSON Web Tokens in source code may contain session secrets or authentication data that should not be hardcoded.",
      "severity": "medium",
      "contexts": [],
      "pattern": "eyJ[A-Za-z0-9_-]+\\.eyJ[A-Za-z0-9_-]+\\.[A-Za-z0-9_-]+",
      "file_extensions": [],
      "remediation": "Generate JWTs dynamically and never commit them to source code.",
      "test_cases": {
        "should_match": [
          "eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiIxMjM0NTY3ODkwIn0.abc123def456ghi789"
        ],
        "should_not_match": [
          "eyJhbGci",
          "jwt_token = generate_token()"
        ]
      }
    },
    {
      "id": "SECRET-006",
      "title": "Private key block",
      "description": "PEM-encoded private keys in source code enable impersonation, decryption, and signing of data.",
      "severity": "high",
      "contexts": [],
      "pattern": "-----BEGIN (RSA |EC |DSA |OPENSSH )?PRIVATE KEY-----",
      "file_extensions": [],
      "remediation": "Store private keys in secure key management systems, not in source code.",
      "test_cases": {
        "should_match": [
          "-----BEGIN RSA PRIVATE KEY-----",
          "-----BEGIN PRIVATE KEY-----",
          "-----BEGIN EC PRIVATE KEY-----",
          "-----BEGIN OPENSSH PRIVATE KEY-----"
        ],
        "should_not_match": [
          "-----BEGIN PUBLIC KEY-----",
          "-----BEGIN CERTIFICATE-----"
        ]
      }
    },
    {
      "id": "SECRET-007",
      "title": "Hardcoded password or secret assignment",
      "description": "Passwords, API keys, and secrets assigned as string literals in source code are easily extracted.",
      "severity": "medium",
      "contexts": [],
      "patterns": [
        "(password|passwd|pwd)\\s*=\\s*['\"][^'\"]{8,}['\"]",
        "(api_key|apikey|api-key)\\s*=\\s*['\"][^'\"]{16,}['\"]",
        "(secret|token)\\s*=\\s*['\"][^'\"]{16,}['\"]"
      ],
      "file_extensions": ["py", "js", "ts", "sh"],
      "remediation": "Read secrets from environment variables, config files excluded from version control, or a secrets manager.",
      "test_cases": {
        "should_match": [
          "password = \"mysecretpassword123\"",
          "api_key = \"abcdefghijklmnopqrstuvwxyz\"",
          "secret = \"super_secret_value_1234567\""
        ],
        "should_not_match": [
          "password = os.getenv('PASSWORD')",
          "password = \"short\"",
          "api_key = \"\"",
          "password = input('Enter password: ')"
        ]
      }
    },
    {
      "id": "SECRET-008",
      "title": "Database connection string with credentials",
      "description": "Connection strings containing embedded credentials expose database access to anyone reading the source.",
      "severity": "medium",
      "contexts": [],
      "pattern": "(mongodb|mysql|postgresql|postgres)://[^:]+:[^@]+@",
      "file_extensions": [],
      "remediation": "Use environment variables for database connection strings.",
      "test_cases": {
        "should_match": [
          "mongodb://admin:pass123@db.example.com:27017/mydb",
          "postgresql://user:secret@localhost:5432/db",
          "mysql://root:password@127.0.0.1/app"
        ],
        "should_not_match": [
          "mongodb://localhost:27017/mydb",
          "postgresql://localhost/db"
        ]
      }
    }
  ]
}
