{
  "$schema": "../rule-schema.json",
  "category": "Credential Access",
  "rules": [
    {
      "id": "FILE-001",
      "title": "SSH key access",
      "description": "Accessing SSH keys could lead to unauthorized access to systems.",
      "severity": "critical",
      "contexts": ["code", "skill", "plugin"],
      "pattern": "['\"]([~.])?/?(\\.ssh|ssh)/(id_rsa|id_ed25519|id_ecdsa|known_hosts|authorized_keys|config)['\"]",
      "file_extensions": [],
      "remediation": "SSH key access should be strictly audited and justified."
    },
    {
      "id": "FILE-002",
      "title": "AWS credentials access",
      "description": "Accessing AWS credentials could lead to cloud infrastructure compromise.",
      "severity": "critical",
      "contexts": ["code", "skill", "plugin"],
      "pattern": "['\"]([~.])?/?(\\.aws|aws)/(credentials|config)['\"]",
      "file_extensions": [],
      "remediation": "AWS credential access must be carefully reviewed."
    },
    {
      "id": "FILE-003",
      "title": "Environment file access",
      "description": ".env files often contain secrets and API keys.",
      "severity": "high",
      "contexts": ["code", "skill", "plugin"],
      "pattern": "['\"]\\.env(\\.local|\\.development|\\.production|\\.test)?['\"]",
      "file_extensions": ["js", "ts", "mjs", "cjs", "py", "rb", "sh", "bash", "zsh", "md", "txt", "yaml", "yml"],
      "remediation": "Review why .env files are being accessed."
    },
    {
      "id": "FILE-004",
      "title": "Browser data access",
      "description": "Accessing browser storage may expose cookies, passwords, or history.",
      "severity": "critical",
      "contexts": ["code", "skill", "plugin"],
      "pattern": "['\"].*(Chrome|Firefox|Safari|Edge)/.*(Cookies|Login Data|History|Local Storage)['\"]",
      "file_extensions": [],
      "remediation": "Browser data access is highly sensitive and suspicious."
    },
    {
      "id": "FILE-005",
      "title": "Keychain/credential store access",
      "description": "Accessing system credential stores is highly suspicious.",
      "severity": "critical",
      "contexts": ["code", "skill", "plugin"],
      "pattern": "['\"](.*/)?(keychain|credential-store|gnome-keyring|kwallet)['\"]",
      "file_extensions": [],
      "remediation": "Credential store access must be justified and audited."
    },
    {
      "id": "CRED-001",
      "title": "SSH directory access pattern",
      "description": "Accessing .ssh directory contents suggests credential theft.",
      "severity": "critical",
      "contexts": ["code", "skill", "plugin"],
      "pattern": "([^\\\\]\\.ssh[/\\\\]|homedir\\(\\)[^)]*\\.ssh|HOME[^)]*\\.ssh)",
      "file_extensions": [],
      "remediation": "SSH key access must be strictly justified."
    },
    {
      "id": "CRED-002",
      "title": "AWS directory access pattern",
      "description": "Accessing .aws directory suggests cloud credential theft.",
      "severity": "critical",
      "contexts": ["code", "skill", "plugin"],
      "pattern": "([^\\\\]\\.aws[/\\\\]|homedir\\(\\)[^)]*\\.aws|HOME[^)]*\\.aws)",
      "file_extensions": [],
      "remediation": "AWS credential access must be justified."
    },
    {
      "id": "CRED-003",
      "title": "Environment variable harvesting",
      "description": "Bulk access to process.env may be harvesting secrets.",
      "severity": "high",
      "contexts": ["code", "skill", "plugin"],
      "pattern": "(process\\.env\\s*[,\\}]|JSON\\.stringify\\s*\\([^)]*process\\.env|Object\\.(keys|entries|values)\\s*\\(\\s*process\\.env)",
      "file_extensions": ["js", "ts", "mjs", "cjs"],
      "remediation": "Avoid bulk access to environment variables."
    },
    {
      "id": "CRED-004",
      "title": "Python environment harvesting",
      "description": "Bulk access to os.environ may be harvesting secrets.",
      "severity": "medium",
      "contexts": ["code", "skill", "plugin"],
      "pattern": "(dict\\s*\\(\\s*os\\.environ\\)|os\\.environ\\.(items|keys)|json\\.dumps\\s*\\([^)]*os\\.environ)",
      "file_extensions": ["py"],
      "remediation": "Avoid bulk access to environment variables."
    },
    {
      "id": "CRED-005",
      "title": "Python Path sensitive directory access",
      "description": "Using Python Path to access sensitive directories like .aws or .ssh.",
      "severity": "critical",
      "contexts": ["code", "skill", "plugin"],
      "pattern": "/\\s*['\"]\\.(aws|ssh)['\"]",
      "file_extensions": ["py"],
      "remediation": "Review access to sensitive directories."
    }
  ]
}
