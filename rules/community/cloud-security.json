{
  "$schema": "../rule-schema.json",
  "category": "Cloud Security",
  "source": "community",
  "rules": [
    {
      "id": "COMM-001",
      "title": "AWS Access Key in Code",
      "description": "Hardcoded AWS access key IDs can lead to unauthorized access to AWS resources. These should never be committed to version control.",
      "severity": "critical",
      "pattern": "AKIA[0-9A-Z]{16}",
      "remediation": "Use environment variables or AWS credential files. Never hardcode access keys. Consider using IAM roles for EC2 instances.",
      "author": "vexscan-community",
      "author_url": "https://github.com/edimuj/vexscan",
      "version": "1.0.0",
      "created": "2026-02-02",
      "updated": "2026-02-02",
      "references": [
        "https://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html",
        "https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/01-Information_Gathering/05-Review_Webpage_Content_for_Information_Leakage"
      ],
      "tags": ["aws", "cloud", "credentials", "secrets"],
      "test_cases": {
        "should_match": [
          "AKIAIOSFODNN7EXAMPLE",
          "const key = 'AKIAI44QH8DHBEXAMPLE'"
        ],
        "should_not_match": [
          "// AKIA is the prefix for AWS keys",
          "AKIAI"
        ]
      }
    },
    {
      "id": "COMM-002",
      "title": "AWS Secret Access Key Pattern",
      "description": "Potential AWS secret access key found. Secret keys provide full access to AWS resources and should never be exposed.",
      "severity": "critical",
      "pattern": "(?i)(aws_secret_access_key|aws_secret_key|secret_access_key)\\s*[=:]\\s*['\"][A-Za-z0-9/+=]{40}['\"]",
      "remediation": "Remove the secret key and rotate it immediately. Use environment variables or AWS Secrets Manager.",
      "author": "vexscan-community",
      "author_url": "https://github.com/edimuj/vexscan",
      "version": "1.0.0",
      "created": "2026-02-02",
      "updated": "2026-02-02",
      "references": [
        "https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_access-keys.html"
      ],
      "tags": ["aws", "cloud", "credentials", "secrets"],
      "test_cases": {
        "should_match": [
          "aws_secret_access_key = 'wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY'",
          "AWS_SECRET_KEY: \"wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY\""
        ],
        "should_not_match": [
          "# aws_secret_access_key should be set in environment",
          "aws_secret_key = process.env.SECRET"
        ]
      }
    },
    {
      "id": "COMM-003",
      "title": "Google Cloud Service Account Key",
      "description": "Service account key file patterns suggest embedded GCP credentials. These provide broad access to GCP resources.",
      "severity": "high",
      "pattern": "\"type\"\\s*:\\s*\"service_account\"",
      "file_extensions": ["json"],
      "remediation": "Use workload identity federation or store service account keys securely outside of code. Never commit to version control.",
      "author": "vexscan-community",
      "author_url": "https://github.com/edimuj/vexscan",
      "version": "1.0.0",
      "created": "2026-02-02",
      "updated": "2026-02-02",
      "references": [
        "https://cloud.google.com/iam/docs/best-practices-for-managing-service-account-keys"
      ],
      "tags": ["gcp", "google-cloud", "cloud", "credentials", "service-account"],
      "test_cases": {
        "should_match": [
          "\"type\": \"service_account\"",
          "{ \"type\" : \"service_account\", \"project_id\": \"my-project\" }"
        ],
        "should_not_match": [
          "// The type is service_account",
          "account_type: service"
        ]
      }
    }
  ]
}
